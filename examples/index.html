<html>

<head></head>

<body>
    <form id="submitBtn">
        <input type="file" name="file" />
        <input type="submit" value="提交" />
    </form>
</body>
<script>
    submitBtn.onsubmit = function (event) {
        event.preventDefault();
        var xhr;
        var api = new CApi("api", {
            baseUrl: 'http://localhost:8080/admin/',
            onRequest: function (req) {
                req.data = {
                    a: 1,
                    b: 2
                }
            },
            onResponse: function (res) {
                return res.json();
            }
        })
        api.post('test/request', {
            account: 'lly',
            password: 'e10adc3949ba59abbe56e057f20f883e',
        }, {
                xhr: function (xmlhttp) {
                    xmlhttp.addEventListener("progress", function (evt) {
                        if (evt.lengthComputable) {
                            var percentComplete = evt.loaded / evt.total;
                            console.log(percentComplete);
                        }
                        console.log(evt)
                    }, false);
                    xhr = xmlhttp;
                },
                onResponse: function (res) {
                    return res;
                }
            }).then(data => {
                console.log(data)
            }).catch(err => console.error(err));

    };
</script>
<script type="text/javascript" src="../dist/charm-api-0.0.1.js"></script>

</html>